module.exports=[568653,a=>{"use strict";a.s(["default",()=>L],568653);var b=a.i(165856),c=a.i(72963),d=a.i(262781),e=a.i(351844),f=a.i(126706);function g(){return(0,b.jsx)("div",{className:"mx-auto max-w-2xl",children:(0,b.jsx)(f.EnhancedMintForm,{})})}var h=a.i(137133),i=a.i(487311),j=a.i(824144);function k(a){let[b,d]=(0,c.useState)([]),[e,f]=(0,c.useState)(!0),[g,h]=(0,c.useState)(null);return(0,c.useEffect)(()=>{let b=async()=>{try{f(!0),h(null);let b=await fetch("/api/marketplace/listings",{next:{revalidate:30}});if(!b.ok)throw Error(`Failed to fetch listings: ${b.statusText}`);let c=(await b.json()).map(a=>({...a,amount:BigInt(a.amount),pricePerItem:BigInt(a.pricePerItem),totalPrice:BigInt(a.totalPrice),blockNumber:BigInt(a.blockNumber)})),e=a?c.filter(b=>b.seller.toLowerCase()===a.toLowerCase()):c;d(e),f(!1)}catch(a){console.error("Failed to fetch marketplace listings:",a),h(a instanceof Error?a.message:"Unknown error"),f(!1)}};b();let c=setInterval(b,3e4);return()=>clearInterval(c)},[a]),{listings:b,isLoading:e,error:g,refetch:()=>{f(!0)}}}var l=a.i(384474),m=a.i(261979),n=a.i(58419),o=a.i(430376),p=a.i(673683),q=a.i(263250),r=a.i(178488),s=a.i(742756);function t(a){let[b,d]=(0,c.useState)([]),[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(null);(0,c.useEffect)(()=>{if(null===a)return void d([]);(async()=>{f(!0),h(null);try{let b=await fetch(`https://explorer.bf1337.org/api/v2/tokens/${p.KEKTECH_VOUCHERS_ADDRESS}/instances/${a}/holders?limit=100`);if(!b.ok)throw Error(`API error: ${b.status}`);let c=((await b.json()).items||[]).map(a=>({address:a.address.hash,balance:BigInt(a.value)}));c.sort((a,b)=>Number(b.balance-a.balance)),d(c)}catch(a){console.error("Failed to fetch voucher holders:",a),h(a instanceof Error?a.message:"Unknown error"),d([])}finally{f(!1)}})()},[a]);let i=b.reduce((a,b)=>a+b.balance,0n);return{holders:b,totalSupply:i,holderCount:b.length,isLoading:e,error:g,refetch:()=>{f(!0)}}}var u=a.i(870362);function v({offer:a,onSuccess:c,canAccept:d}){let{address:e}=(0,h.useAccount)(),{acceptOffer:f,rejectOffer:g,isPending:j}=(0,s.useKektvOffers)(),{metadataMap:k}=(0,r.useAllVoucherMetadata)(),l=k[Number(a.tokenId)],m=l?.animation_url||l?.image,n=l?.name||(0,u.getVoucherName)(Number(a.tokenId)),o=a.offerer.toLowerCase()===e?.toLowerCase(),p=!a.voucherOwner||"0x0000000000000000000000000000000000000000"===a.voucherOwner,q=async()=>{try{await f(a.offerId),alert("Offer accepted successfully! Vouchers transferred to buyer, BASED transferred to you."),c?.()}catch(a){alert(`Accept failed: ${a instanceof Error?a.message:"Unknown error"}`)}},t=async()=>{try{await g(a.offerId),alert("Offer rejected! BASED refunded to offerer."),c?.()}catch(a){alert(`Reject failed: ${a instanceof Error?a.message:"Unknown error"}`)}},v=a.offerPrice*a.amount;return(0,b.jsxs)("div",{className:"bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border border-[#daa520]/20 hover:border-[#daa520]/40 transition-all relative",children:[d&&e&&(0,b.jsxs)("div",{className:"absolute top-3 right-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-xs px-3 py-1 rounded-full font-bold shadow-lg shadow-green-500/30 flex items-center gap-1 z-10",children:[(0,b.jsx)("span",{children:"‚ú®"}),(0,b.jsx)("span",{children:"You can accept"})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[m?(0,b.jsx)("div",{className:"relative w-full h-48 rounded-lg overflow-hidden bg-black/20 mb-4",children:(0,b.jsx)(i.default,{src:m,alt:n,fill:!0,className:"object-contain",unoptimized:!0})}):(0,b.jsx)("div",{className:"text-center mb-4",children:(0,b.jsx)("div",{className:"text-6xl mb-2",children:"üé´"})}),(0,b.jsx)("div",{className:"text-center mb-4",children:(0,b.jsx)("h3",{className:"text-xl font-bold text-[#daa520] font-fredoka",children:n})}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,b.jsx)("span",{children:"Offerer:"}),(0,b.jsxs)("span",{className:"text-white font-mono text-xs",children:[a.offerer.slice(0,6),"...",a.offerer.slice(-4)]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,b.jsx)("span",{children:"Quantity:"}),(0,b.jsx)("span",{className:"text-white font-bold",children:a.amount.toString()})]}),(0,b.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,b.jsx)("span",{children:"Price/Each:"}),(0,b.jsx)("span",{className:"text-white font-bold",children:(0,u.formatOfferPrice)(a.offerPrice)})]}),(0,b.jsxs)("div",{className:"flex justify-between text-gray-400 border-t border-gray-800 pt-2 mt-2",children:[(0,b.jsx)("span",{className:"font-bold",children:"Total:"}),(0,b.jsx)("span",{className:"text-[#daa520] font-bold text-lg",children:(0,u.formatOfferPrice)(v)})]}),(0,b.jsx)("div",{className:"text-xs text-gray-500 text-center mt-1",children:"üí∞ BASED escrowed ‚Ä¢ General offer (anyone can accept)"})]}),o?(0,b.jsx)("div",{className:"mt-4 py-3 rounded-lg bg-gray-700 text-gray-500 text-center font-fredoka font-bold",children:"Your Offer"}):p&&e?(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:[(0,b.jsx)("button",{onClick:q,disabled:j||!d,className:`py-3 rounded-lg font-fredoka font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed ${d?"bg-gradient-to-r from-green-500 to-emerald-600 text-white hover:scale-105 shadow-lg shadow-green-500/30":"bg-gray-700 text-gray-500"}`,title:d?"":"Insufficient voucher balance",children:j?"Processing...":d?"‚úÖ Accept":"‚ùå Insufficient Balance"}),(0,b.jsx)("button",{onClick:t,disabled:j,className:"py-3 rounded-lg font-fredoka font-bold transition-all bg-red-500/20 text-red-400 hover:bg-red-500/30 disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Processing...":"üö´ Reject"})]}):(0,b.jsx)("div",{className:"mt-4 py-3 rounded-lg bg-gray-800 text-gray-500 text-center font-fredoka font-bold text-sm",children:"Connect wallet to accept"})]})]})}let w=[{id:u.VOUCHER_IDS.SILVER,fallbackIcon:"ü•à",color:"gray"},{id:u.VOUCHER_IDS.GOLD,fallbackIcon:"ü•á",color:"gray"},{id:u.VOUCHER_IDS.PLATINUM,fallbackIcon:"üí†",color:"gray"}];function x(){let[a,d]=(0,c.useState)(null),{metadataMap:e}=(0,r.useAllVoucherMetadata)(),{vouchers:f}=(0,l.useUserVoucherBalances)(),{offerIds:g,isLoading:h,refetch:j}=(0,s.useTokenOffers)(a),{holders:k,totalSupply:m,holderCount:n,isLoading:o}=t(a),p=(0,c.useMemo)(()=>null!==a&&f.find(b=>b.id===a)?.balance||0n,[a,f]);return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-[#daa520] mb-4 font-fredoka text-center",children:"Select Voucher Type"}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 max-w-4xl mx-auto",children:w.map(c=>{let f=e[c.id],g=f?.animation_url||f?.image,h=f?.name||c.fallbackIcon,j=a===c.id;return(0,b.jsx)("button",{onClick:()=>d(c.id),className:`
                  bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border overflow-hidden transition-all
                  ${j?"border-[#daa520] ring-2 ring-[#daa520]/50 shadow-lg shadow-[#daa520]/20":"border-[#daa520]/20 hover:border-[#daa520]/40"}
                `,children:(0,b.jsxs)("div",{className:"p-6",children:[g?(0,b.jsx)("div",{className:"relative w-full h-48 rounded-lg overflow-hidden bg-black/20 mb-4",children:(0,b.jsx)(i.default,{src:g,alt:h,fill:!0,className:"object-contain",unoptimized:!0})}):(0,b.jsx)("div",{className:"text-center mb-4",children:(0,b.jsx)("div",{className:"text-6xl mb-2",children:c.fallbackIcon})}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("h3",{className:"text-xl font-bold text-[#daa520] font-fredoka",children:h})})]})},c.id)})})]}),null!==a&&(0,b.jsxs)("div",{className:"bg-gray-900/60 rounded-lg border border-[#daa520]/20 p-6 max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-[#daa520] font-fredoka",children:"Current Holders"}),!o&&(0,b.jsxs)("div",{className:"text-sm text-gray-400",children:[n," holders ‚Ä¢ ",m.toString()," total vouchers"]})]}),o?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-[#daa520] mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Loading holder data..."})]}):0===k.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500 text-sm",children:"No holders found for this voucher type"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{className:"text-xs text-gray-400 mb-4",children:"üí° General offers can be accepted by any holder listed below (first come, first served)"}),(0,b.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:k.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-black/20 rounded-lg hover:bg-black/30 transition",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"text-xs text-gray-500 font-mono",children:["#",c+1]}),(0,b.jsxs)("div",{className:"font-mono text-sm text-gray-300",children:[a.address.slice(0,6),"...",a.address.slice(-4)]})]}),(0,b.jsxs)("div",{className:"text-sm font-bold text-[#daa520]",children:[a.balance.toString(),"√ó vouchers"]})]},a.address))})]})]}),null===a?(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"üëÜ"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:"Select a Voucher Type"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"Choose a voucher type above to see all active offers"})]}):h?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-[#daa520] mb-6 font-fredoka text-center",children:"Loading Offers..."}),(0,b.jsx)("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(a=>(0,b.jsx)(A,{},a))})]}):0===g.length?(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"üíº"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:"No Active Offers"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"No one has made offers on this voucher type yet. Be the first!"})]}):(0,b.jsx)(y,{offerIds:g,onSuccess:j,userBalance:p})]})}function y({offerIds:a,onSuccess:d,userBalance:e}){let[f,g]=(0,c.useState)(0);return(0,c.useEffect)(()=>{g(0)},[a]),(0,b.jsxs)("div",{children:[f>0&&(0,b.jsxs)("h3",{className:"text-xl font-bold text-[#daa520] mb-6 font-fredoka text-center",children:["Active Offers (",f,")"]}),(0,b.jsx)("div",{className:`grid gap-6 ${1===f?"grid-cols-1 max-w-md mx-auto":2===f?"grid-cols-1 sm:grid-cols-2 max-w-4xl mx-auto":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"}`,children:a.map(a=>(0,b.jsx)(z,{offerId:a,onSuccess:d,userBalance:e,onActiveChange:a=>{a&&g(a=>a+1)}},a.toString()))}),a.length>0&&0===f&&(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)("div",{className:"text-7xl mb-4",children:"‚è≥"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-3 font-fredoka",children:"All Offers Inactive"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"All offers for this voucher have been accepted, cancelled, or expired. Check back later for new offers!"})]})]})}function z({offerId:a,onSuccess:d,userBalance:e,onActiveChange:f}){let{offer:g,isLoading:h}=(0,s.useOfferDetails)(a),i=(0,c.useRef)(!1),j=g&&e>=g.amount;return((0,c.useEffect)(()=>{!h&&g&&g.active&&f&&!i.current&&(f(!0),i.current=!0)},[h,g,f]),!h&&g&&g.active)?(0,b.jsx)(v,{offer:g,onSuccess:d,canAccept:j}):null}function A(){return(0,b.jsx)("div",{className:"bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border border-[#daa520]/20 animate-pulse",children:(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsx)("div",{className:"relative w-full h-48 rounded-lg bg-gray-800/50"}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("div",{className:"h-6 bg-gray-800/50 rounded w-2/3 mx-auto"})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-800/50 rounded w-20"}),(0,b.jsx)("div",{className:"h-4 bg-gray-800/50 rounded w-24"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-800/50 rounded w-20"}),(0,b.jsx)("div",{className:"h-4 bg-gray-800/50 rounded w-16"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-800/50 rounded w-24"}),(0,b.jsx)("div",{className:"h-4 bg-gray-800/50 rounded w-20"})]}),(0,b.jsxs)("div",{className:"flex justify-between border-t border-gray-800 pt-2 mt-2",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-800/50 rounded w-16"}),(0,b.jsx)("div",{className:"h-5 bg-gray-800/50 rounded w-24"})]})]}),(0,b.jsx)("div",{className:"mt-4 h-12 bg-gray-800/50 rounded-lg"})]})})}let B=[{id:u.VOUCHER_IDS.SILVER,fallbackIcon:"ü•à",color:"gray"},{id:u.VOUCHER_IDS.GOLD,fallbackIcon:"ü•á",color:"gray"},{id:u.VOUCHER_IDS.PLATINUM,fallbackIcon:"üí†",color:"gray"}];function C(){let{address:a}=(0,h.useAccount)(),{makeOffer:d,isPending:e}=(0,s.useKektvOffers)(),{metadataMap:f}=(0,r.useAllVoucherMetadata)(),[g,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),{holders:o,totalSupply:p,holderCount:q,isLoading:v}=t(g),w=async()=>{if(null===g||!k||!m)return void alert("Please fill in all fields");let a=BigInt(k),b=BigInt(Math.floor(100*Number(m)))/100n;if(!(0,u.meetsMinimumOffer)(a,b*BigInt(1e18)))return void alert("Offer total must be at least 0.001 BASED");try{await d(g,a,m),alert("Offer created successfully! BASED escrowed in contract."),j(null),l(""),n("")}catch(a){alert(`Make offer failed: ${a instanceof Error?a.message:"Unknown error"}`)}};return a?(0,b.jsx)("div",{className:"max-w-2xl mx-auto space-y-6",children:(0,b.jsxs)("div",{className:"bg-gray-900/60 rounded-lg border border-[#daa520]/20 p-6",children:[(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-6 font-fredoka",children:"Make an Offer"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-400 mb-3 text-center",children:"Select Voucher Type"}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:B.map(a=>{let c=f[a.id],d=c?.animation_url||c?.image,e=c?.name||a.fallbackIcon,h=g===a.id;return(0,b.jsx)("button",{onClick:()=>j(a.id),className:`
                      bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border overflow-hidden transition-all
                      ${h?"border-[#daa520] ring-2 ring-[#daa520]/50 shadow-lg shadow-[#daa520]/20":"border-[#daa520]/20 hover:border-[#daa520]/40"}
                    `,children:(0,b.jsxs)("div",{className:"p-4",children:[d?(0,b.jsx)("div",{className:"relative w-full h-32 rounded-lg overflow-hidden bg-black/20 mb-3",children:(0,b.jsx)(i.default,{src:d,alt:e,fill:!0,className:"object-contain",unoptimized:!0})}):(0,b.jsx)("div",{className:"text-center mb-3",children:(0,b.jsx)("div",{className:"text-5xl mb-2",children:a.fallbackIcon})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-bold text-[#daa520] font-fredoka",children:e}),h&&(0,b.jsx)("div",{className:"text-xs text-[#daa520] mt-1",children:"‚úì Selected"})]})]})},a.id)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-400 mb-2",children:"Quantity"}),(0,b.jsx)("input",{type:"number",min:"1",value:k,onChange:a=>l(a.target.value),placeholder:"Enter quantity (e.g., 3)",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:border-[#daa520] focus:outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-400 mb-2",children:"Total BASED to Offer"}),(0,b.jsx)("input",{type:"number",min:"0.001",step:"0.001",value:m,onChange:a=>n(a.target.value),placeholder:"Enter total BASED (e.g., 500)",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:border-[#daa520] focus:outline-none"}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Minimum total offer: 0.001 BASED"})]}),k&&m&&(0,b.jsxs)("div",{className:"bg-[#daa520]/10 border border-[#daa520]/30 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Total BASED:"}),(0,b.jsxs)("span",{className:"text-2xl font-bold text-[#daa520]",children:[Number(m).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," BASED"]})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Price Per Voucher:"}),(0,b.jsxs)("span",{className:"text-gray-300",children:[(Number(m)/Number(k)).toFixed(3)," BASED"]})]})]}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"BASED will be escrowed in contract until offer is accepted or canceled"})]}),null!==g&&(0,b.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)("div",{className:"text-blue-400 font-fredoka font-bold",children:"üìä Market Info"})}),!v&&(0,b.jsxs)("div",{className:"text-xs text-gray-400",children:[q," holders ‚Ä¢ ",p.toString()," total"]})]}),v?(0,b.jsxs)("div",{className:"text-center py-4",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-blue-400 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Loading holder data..."})]}):0===o.length?(0,b.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm",children:"No current holders"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"text-xs text-gray-400 mb-3",children:["üí° ",(0,b.jsx)("strong",{children:"General Offer:"})," Any holder below can accept (first come, first served)"]}),(0,b.jsxs)("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:[o.slice(0,5).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 bg-black/20 rounded text-xs",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-gray-500",children:["#",c+1]}),(0,b.jsxs)("span",{className:"font-mono text-gray-300",children:[a.address.slice(0,6),"...",a.address.slice(-4)]})]}),(0,b.jsxs)("span",{className:"text-blue-400 font-bold",children:[a.balance.toString(),"√ó"]})]},a.address)),o.length>5&&(0,b.jsxs)("div",{className:"text-center text-xs text-gray-500 mt-2",children:["+",o.length-5," more holders"]})]})]})]}),(0,b.jsx)("button",{onClick:w,disabled:e||!g||!k||!m,className:`
              w-full py-4 rounded-lg font-fredoka font-bold text-lg transition-all
              ${e||!g||!k||!m?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-[#daa520] to-yellow-600 text-black hover:scale-105 shadow-lg shadow-[#daa520]/20"}
            `,children:e?"‚è≥ Creating Offer...":"üí∞ Make Offer with BASED"})]})]})}):(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"üîå"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:"Connect Your Wallet"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"Connect your wallet to make offers on KEKTV vouchers"})]})}function D(){let[a,d]=(0,c.useState)("marketplace");return(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsx)("div",{className:"sticky top-0 z-20 bg-black/90 backdrop-blur-sm border-b border-gray-700/50",children:(0,b.jsxs)("div",{className:"flex items-center justify-around py-4 px-6",children:[(0,b.jsxs)("button",{onClick:()=>d("marketplace"),className:`flex items-center gap-3 px-6 py-2 rounded-lg transition-all cursor-pointer ${"marketplace"===a?"bg-[#daa520]/20 border border-[#daa520]/50":"border border-transparent hover:bg-gray-800/50"}`,children:[(0,b.jsx)("span",{className:"text-3xl",children:"üè™"}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-[#daa520]",children:"All Offers"}),(0,b.jsx)("div",{className:"text-xs text-gray-400 whitespace-nowrap",children:"Browse marketplace"})]})]}),(0,b.jsxs)("button",{onClick:()=>d("create"),className:`flex items-center gap-3 px-6 py-2 rounded-lg transition-all cursor-pointer ${"create"===a?"bg-[#daa520]/20 border border-[#daa520]/50":"border border-transparent hover:bg-gray-800/50"}`,children:[(0,b.jsx)("span",{className:"text-3xl",children:"‚ûï"}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-[#daa520]",children:"Create Offer"}),(0,b.jsx)("div",{className:"text-xs text-gray-400 whitespace-nowrap",children:"Make new offer"})]})]})]})}),(0,b.jsxs)("div",{className:"p-6",children:["marketplace"===a&&(0,b.jsx)(x,{}),"create"===a&&(0,b.jsx)(C,{})]})]})}var E=a.i(755131);function F(){let[a,d]=(0,c.useState)("browse"),[e,f]=(0,c.useState)(null),{isConnected:g}=(0,h.useAccount)();return null!==e?(0,b.jsx)(J,{tokenId:e,onBack:()=>f(null)}):(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"text-4xl font-bold text-[#daa520] mb-4 font-fredoka",children:"ùïÇ∆éùïÇTV Voucher Marketplace"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"Trade your ùïÇ∆éùïÇTECH Vouchers with the community"})]}),g&&(0,b.jsxs)("div",{className:"flex justify-center gap-4 flex-wrap",children:[(0,b.jsx)("button",{onClick:()=>d("browse"),className:`
              px-6 py-2 rounded-lg font-fredoka font-bold transition-all
              ${"browse"===a?"bg-[#daa520] text-black shadow-lg shadow-[#daa520]/20":"bg-gray-800 text-[#daa520] hover:text-white hover:bg-gray-700"}
            `,children:"Browse & Buy"}),(0,b.jsx)("button",{onClick:()=>d("list"),className:`
              px-6 py-2 rounded-lg font-fredoka font-bold transition-all
              ${"list"===a?"bg-[#daa520] text-black shadow-lg shadow-[#daa520]/20":"bg-gray-800 text-[#daa520] hover:text-white hover:bg-gray-700"}
            `,children:"List for Sale"}),(0,b.jsx)("button",{onClick:()=>d("offers"),className:`
              px-6 py-2 rounded-lg font-fredoka font-bold transition-all
              ${"offers"===a?"bg-[#daa520] text-black shadow-lg shadow-[#daa520]/20":"bg-gray-800 text-[#daa520] hover:text-white hover:bg-gray-700"}
            `,children:"Offers"}),(0,b.jsx)("button",{onClick:()=>d("activity"),className:`
              px-6 py-2 rounded-lg font-fredoka font-bold transition-all
              ${"activity"===a?"bg-[#daa520] text-black shadow-lg shadow-[#daa520]/20":"bg-gray-800 text-[#daa520] hover:text-white hover:bg-gray-700"}
            `,children:"My Trading Activity"})]}),"browse"===a?(0,b.jsx)(G,{onSelectNFT:f}):"offers"===a?g?(0,b.jsx)(D,{}):(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"üîå"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:"Connect Your Wallet"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"Connect your wallet to view and make offers"})]}):"activity"===a?(0,b.jsx)(E.UserActivityPage,{}):g?(0,b.jsx)(H,{}):(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"üîå"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:"Connect Your Wallet"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"Connect your wallet to list your vouchers for sale"})]})]})}function G({onSelectNFT:a}){let{address:c,isConnected:d}=(0,h.useAccount)(),{listings:e,isLoading:f}=k(),g=(0,j.useKektvMarketplace)(),{metadataMap:l,loading:m}=(0,r.useAllVoucherMetadata)(),n=[...e].sort((a,b)=>{if(a.tokenId!==b.tokenId)return a.tokenId-b.tokenId;let c=BigInt(a.pricePerItem),d=BigInt(b.pricePerItem);return c<d?-1:+(c>d)}),o=new Set(e.map(a=>a.tokenId)),p=[1,2,3].filter(a=>!o.has(a)),q=async a=>{if(c)try{await g.buyVoucher(a.seller,BigInt(a.tokenId),BigInt(a.amount),BigInt(a.totalPrice)),alert("Purchase successful! Vouchers transferred to your wallet.")}catch(a){alert(`Purchase failed: ${a instanceof Error?a.message:"Unknown error"}`)}};return f||m?(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#daa520] mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Loading marketplace..."})]}):(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[n.map((e,f)=>{let h=l[e.tokenId],j=h?.animation_url||h?.image,k=n.filter(a=>a.tokenId===e.tokenId),m=k[0].seller===e.seller&&k[0].pricePerItem===e.pricePerItem;return(0,b.jsx)("div",{className:"bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border border-[#daa520]/20 hover:border-[#daa520]/40 overflow-hidden transition-all",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{onClick:()=>a(e.tokenId),className:"cursor-pointer hover:opacity-80 transition-opacity",children:[j?(0,b.jsx)("div",{className:"relative w-full h-48 rounded-lg overflow-hidden bg-black/20 mb-4",children:(0,b.jsx)(i.default,{src:j,alt:h?.name||`Voucher #${e.tokenId}`,fill:!0,className:"object-contain",unoptimized:!0})}):(0,b.jsx)("div",{className:"text-center mb-4",children:(0,b.jsx)("div",{className:"text-6xl mb-2",children:0===e.tokenId?"üé´":1===e.tokenId?"üéüÔ∏è":2===e.tokenId?"üèÜ":"üíé"})}),(0,b.jsxs)("div",{className:"text-center mb-4",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-[#daa520] font-fredoka",children:h?.name||`Voucher #${e.tokenId}`}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Click to view details"})]})]}),(0,b.jsx)("div",{className:"mb-3 p-2 bg-black/20 rounded-lg",children:(0,b.jsxs)("p",{className:"text-xs text-gray-400 text-center",children:["Seller: ",(0,b.jsxs)("span",{className:"text-white font-mono",children:[e.seller.slice(0,6),"...",e.seller.slice(-4)]}),e.seller===c&&(0,b.jsx)("span",{className:"ml-2 text-[#daa520] font-bold",children:"(You)"})]})}),m&&k.length>1&&(0,b.jsx)("div",{className:"mb-3 p-2 bg-green-900/30 border border-green-600/30 rounded-lg",children:(0,b.jsx)("p",{className:"text-xs text-green-400 text-center font-bold",children:"‚úÖ Best Price for this NFT!"})}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,b.jsx)("span",{children:"Quantity:"}),(0,b.jsx)("span",{className:"text-white font-bold",children:e.amount.toString()})]}),(0,b.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,b.jsx)("span",{children:"Price/Each:"}),(0,b.jsxs)("span",{className:"text-white font-bold",children:[(Number(e.pricePerItem)/1e18).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," BASED"]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-gray-400 border-t border-gray-800 pt-2 mt-2",children:[(0,b.jsx)("span",{className:"font-bold",children:"You Pay:"}),(0,b.jsxs)("span",{className:"text-[#daa520] font-bold text-lg",children:[(Number(e.totalPrice)/1e18).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," BASED"]})]}),(0,b.jsx)("div",{className:"text-xs text-gray-500 text-center mt-1",children:"2.5% platform fee deducted from seller"})]}),(0,b.jsx)("button",{onClick:()=>q(e),disabled:!d||g.isPending||e.seller===c,className:`
                    w-full mt-4 py-3 rounded-lg font-fredoka font-bold transition-all
                    ${!d||e.seller===c?"bg-gray-700 text-gray-500 cursor-not-allowed":m?"bg-gradient-to-r from-green-600 to-green-500 text-white hover:scale-105 shadow-lg shadow-green-600/20":"bg-gradient-to-r from-[#daa520] to-yellow-600 text-black hover:scale-105 shadow-lg shadow-[#daa520]/20"}
                  `,children:d?e.seller===c?"Your Listing":g.isPending?"Buying...":"üí∞ Buy Now":"üîó Connect Wallet to Buy"})]})},`listing-${e.seller}-${e.tokenId}-${f}`)}),p.map(c=>{let d=l[c],e=d?.animation_url||d?.image;return(0,b.jsx)("div",{className:"bg-gradient-to-br from-gray-800/30 to-gray-900/30 rounded-lg border border-gray-700/50 hover:border-gray-600/50 overflow-hidden transition-all",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{onClick:()=>a(c),className:"cursor-pointer hover:opacity-80 transition-opacity",children:[e?(0,b.jsx)("div",{className:"relative w-full h-48 rounded-lg overflow-hidden bg-black/20 mb-4",children:(0,b.jsx)(i.default,{src:e,alt:d?.name||`Voucher #${c}`,fill:!0,className:"object-contain",unoptimized:!0})}):(0,b.jsx)("div",{className:"text-center mb-4",children:(0,b.jsx)("div",{className:"text-6xl mb-2",children:0===c?"üé´":1===c?"üéüÔ∏è":2===c?"üèÜ":"üíé"})}),(0,b.jsxs)("div",{className:"text-center mb-4",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-[#daa520] font-fredoka",children:d?.name||`Voucher #${c}`}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Click to view details"})]})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-6 text-center",children:[(0,b.jsx)("div",{className:"text-4xl mb-2",children:"üì≠"}),(0,b.jsx)("p",{className:"text-gray-400 font-fredoka font-bold mb-1",children:"Not Listed"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"No active listings for this voucher"})]})})]})},`unlisted-${c}`)})]})})}function H(){let{vouchers:a,isLoading:d}=(0,l.useUserVoucherBalances)(),e=function(){let{address:a}=(0,h.useAccount)(),{writeContractAsync:b,data:d,isPending:e,error:f}=(0,m.useWriteContract)(),{isLoading:g,isSuccess:i}=(0,n.useWaitForTransactionReceipt)({hash:d}),{data:j,isLoading:k,refetch:l}=(0,o.useReadContract)({address:p.KEKTECH_VOUCHERS.address,abi:p.KEKTECH_VOUCHERS.abi,functionName:"isApprovedForAll",args:a?[a,q.KEKTV_MARKETPLACE_ADDRESS]:void 0,query:{enabled:!!a,staleTime:0,gcTime:0}});return(0,c.useEffect)(()=>{a&&console.log("üîê Approval Status Debug:",{userAddress:a,marketplaceAddress:q.KEKTV_MARKETPLACE_ADDRESS,isApprovedRaw:j,isApprovedBoolean:!!j,isLoading:k})},[a,j,k]),{isApproved:!!j,isLoading:k,approveMarketplace:async()=>{if(!a)throw Error("Wallet not connected");try{return await b({address:p.KEKTECH_VOUCHERS.address,abi:p.KEKTECH_VOUCHERS.abi,functionName:"setApprovalForAll",args:[q.KEKTV_MARKETPLACE_ADDRESS,!0]})}catch(a){throw a}},isPending:e,isConfirming:g,isSuccess:i,error:f,hash:d,refetch:l}}(),f=(0,j.useKektvMarketplace)(),{metadataMap:g,loading:k}=(0,r.useAllVoucherMetadata)(),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)("");(0,c.useEffect)(()=>{if(e.isSuccess){let a=setTimeout(async()=>{await e.refetch(),alert("Marketplace approved! You can now list vouchers.")},2e3);return()=>clearTimeout(a)}},[e.isSuccess,e.refetch]);let y=async()=>{try{await e.approveMarketplace()}catch(a){alert(`Approval failed: ${a instanceof Error?a.message:"Unknown error"}`)}},z=async()=>{if(null===s||!u||!w)return void alert("Please fill in all fields");try{await f.listVoucher(BigInt(s),BigInt(u),w),alert("Voucher listed successfully!"),t(null),v(""),x("")}catch(a){alert(`Listing failed: ${a instanceof Error?a.message:"Unknown error"}`)}};if(d||k)return(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#daa520] mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Loading your vouchers..."})]});let A=a.filter(a=>a.balance>0n);return 0===A.length?(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"üé´"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:"No Vouchers to List"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"You don't own any KEKTV vouchers yet. Mint or buy some to start trading!"})]}):(0,b.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.isLoading?(0,b.jsx)("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-blue-500"}),(0,b.jsx)("p",{className:"text-blue-400",children:"Checking marketplace approval status..."})]})}):!e.isApproved&&(0,b.jsxs)("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-yellow-400 mb-2 font-fredoka",children:"üîê Marketplace Approval Required"}),(0,b.jsx)("p",{className:"text-gray-400 mb-4",children:"You need to approve the marketplace to transfer your vouchers. This is a one-time approval."}),(0,b.jsx)("button",{onClick:y,disabled:e.isPending,className:"px-6 py-3 bg-yellow-500 text-black rounded-lg font-fredoka font-bold hover:bg-yellow-400 transition disabled:opacity-50",children:e.isPending?"Approving...":"Approve Marketplace"})]}),(0,b.jsxs)("div",{className:"bg-gray-900/60 rounded-lg border border-[#daa520]/20 p-6",children:[(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-6 font-fredoka",children:"List Vouchers for Sale"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{children:(0,b.jsx)("div",{className:"grid grid-cols-1 gap-4",children:A.map(a=>{let c=g[a.id],d=c?.animation_url||c?.image,e=s===a.id;return(0,b.jsx)("button",{onClick:()=>t(a.id),className:`
                      rounded-xl border p-4 transition-all text-left
                      ${e?"bg-gradient-to-br from-[#daa520]/20 to-yellow-600/20 border-[#daa520] ring-2 ring-[#daa520]/50":"bg-gradient-to-br from-yellow-500/10 to-yellow-600/10 border-yellow-500/30 hover:border-[#daa520]/50"}
                    `,children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[d?(0,b.jsx)("div",{className:"relative w-full sm:w-32 h-32 rounded-lg overflow-hidden bg-black/20 flex-shrink-0",children:(0,b.jsx)(i.default,{src:d,alt:c?.name||a.name,fill:!0,className:"object-contain",unoptimized:!0})}):(0,b.jsx)("div",{className:"w-full sm:w-32 h-32 flex items-center justify-center bg-black/20 rounded-lg flex-shrink-0",children:(0,b.jsx)("div",{className:"text-6xl",children:a.icon})}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsx)("h4",{className:"font-bold text-white text-lg font-fredoka",children:c?.name||a.name}),(0,b.jsxs)("div",{className:"px-3 py-1 rounded-lg bg-gradient-to-r from-[#daa520] to-yellow-600 text-black text-sm font-bold flex-shrink-0",children:["√ó",a.balance.toString()]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:c?.description||`Token ID #${a.id}`})]}),e&&(0,b.jsx)("div",{className:"text-xs text-[#daa520] font-bold mt-2",children:"‚úì Selected for listing"})]})]})},a.id)})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-400 mb-2",children:"Quantity to List"}),(0,b.jsx)("input",{type:"number",min:"1",max:null!==s?Number(A.find(a=>a.id===s)?.balance):void 0,value:u,onChange:a=>v(a.target.value),placeholder:"Enter quantity",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:border-[#daa520] focus:outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-400 mb-2",children:"Price Per Voucher (BASED)"}),(0,b.jsx)("input",{type:"number",min:"1",value:w,onChange:a=>x(a.target.value),placeholder:"Enter price (e.g., 1000)",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:border-[#daa520] focus:outline-none"})]}),u&&w&&(0,b.jsxs)("div",{className:"bg-[#daa520]/10 border border-[#daa520]/30 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Total Sale Price:"}),(0,b.jsxs)("span",{className:"text-2xl font-bold text-[#daa520]",children:[(Number(u)*Number(w)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," BASED"]})]}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"You'll receive 97.5% after 2.5% platform fee"})]}),(0,b.jsx)("button",{onClick:z,disabled:!e.isApproved||f.isPending||!s||!u||!w,className:`
              w-full py-4 rounded-lg font-fredoka font-bold text-lg transition-all
              ${!e.isApproved||f.isPending||!s||!u||!w?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-[#daa520] to-yellow-600 text-black hover:scale-105 shadow-lg shadow-[#daa520]/20"}
            `,children:e.isApproved?f.isPending?"‚è≥ Listing...":"üí∞ List for Sale":"üîê Approve Marketplace First"})]})]}),(0,b.jsx)(I,{})]})}function I(){let{address:a}=(0,h.useAccount)(),{listings:c,isLoading:d}=k(a),e=(0,j.useKektvMarketplace)(),{metadataMap:f,loading:g}=(0,r.useAllVoucherMetadata)(),l=async a=>{try{await e.cancelListing(BigInt(a)),alert("Listing cancelled successfully!")}catch(a){alert(`Cancellation failed: ${a instanceof Error?a.message:"Unknown error"}`)}};return d||g||0===c.length?null:(0,b.jsxs)("div",{className:"bg-gray-900/60 rounded-lg border border-[#daa520]/20 p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-[#daa520] mb-4 font-fredoka",children:"Your Active Listings"}),(0,b.jsx)("div",{className:"space-y-3",children:c.map(a=>{let c=f[a.tokenId],d=c?.animation_url||c?.image;return(0,b.jsx)("div",{className:"rounded-lg border border-[#daa520]/30 bg-gradient-to-br from-yellow-500/10 to-yellow-600/10 p-4 hover:border-[#daa520]/50 transition-all",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[d?(0,b.jsx)("div",{className:"relative w-20 h-20 rounded-lg overflow-hidden bg-black/20 flex-shrink-0",children:(0,b.jsx)(i.default,{src:d,alt:c?.name||a.voucherName,fill:!0,className:"object-contain",unoptimized:!0})}):(0,b.jsx)("div",{className:"w-20 h-20 flex items-center justify-center bg-black/20 rounded-lg flex-shrink-0",children:(0,b.jsx)("div",{className:"text-4xl",children:a.voucherIcon})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-bold text-white text-lg font-fredoka mb-1",children:c?.name||a.voucherName}),(0,b.jsxs)("div",{className:"text-sm text-gray-400",children:[(0,b.jsx)("span",{className:"text-white font-bold",children:a.amount.toString()})," √ó ",(Number(a.pricePerItem)/1e18).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," BASED each"]}),(0,b.jsxs)("div",{className:"text-xs text-[#daa520] mt-1",children:["Total: ",(Number(a.totalPrice)/1e18).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," BASED"]})]}),(0,b.jsx)("button",{onClick:()=>l(a.tokenId),disabled:e.isPending,className:"px-4 py-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition disabled:opacity-50 font-fredoka font-bold whitespace-nowrap",children:e.isPending?"Cancelling...":"Cancel Listing"})]})},a.tokenId)})})]})}function J({tokenId:a,onBack:c}){let{metadata:d,loading:e,error:f}=(0,r.useVoucherMetadata)(a),{listings:g,isLoading:l}=k(),{address:m,isConnected:n}=(0,h.useAccount)(),o=(0,j.useKektvMarketplace)(),p=g.filter(b=>b.tokenId===a).sort((a,b)=>{let c=BigInt(a.pricePerItem),d=BigInt(b.pricePerItem);return c<d?-1:+(c>d)}),q=async a=>{if(m)try{await o.buyVoucher(a.seller,BigInt(a.tokenId),BigInt(a.amount),BigInt(a.totalPrice)),alert("Purchase successful! Vouchers transferred to your wallet.")}catch(a){alert(`Purchase failed: ${a instanceof Error?a.message:"Unknown error"}`)}};if(e)return(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#daa520] mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Loading NFT details..."})]});if(f||!d)return(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"‚ùå"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:"Error Loading NFT"}),(0,b.jsx)("p",{className:"text-gray-400 mb-6",children:f||"Failed to load NFT metadata"}),(0,b.jsx)("button",{onClick:c,className:"px-6 py-3 bg-[#daa520] text-black rounded-lg font-fredoka font-bold hover:bg-yellow-600 transition",children:"‚Üê Back to Marketplace"})]});let s=d.animation_url||d.image;return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsx)("button",{onClick:c,className:"px-4 py-2 bg-gray-800 text-[#daa520] rounded-lg font-fredoka font-bold hover:bg-gray-700 transition",children:"‚Üê Back to Marketplace"}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-[#daa520] mb-2 font-fredoka",children:d.name}),(0,b.jsx)("p",{className:"text-gray-400",children:"Complete details and metadata for this NFT"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)("div",{className:"bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border border-[#daa520]/20 p-6",children:s?(0,b.jsx)("div",{className:"relative w-full aspect-square rounded-lg overflow-hidden bg-black/20",children:(0,b.jsx)(i.default,{src:s,alt:d.name,fill:!0,className:"object-contain",unoptimized:!0})}):(0,b.jsx)("div",{className:"w-full aspect-square flex items-center justify-center bg-black/20 rounded-lg",children:(0,b.jsx)("div",{className:"text-9xl",children:"üéüÔ∏è"})})}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border border-[#daa520]/20 p-6 space-y-4",children:[d.description&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-[#daa520] mb-2 font-fredoka",children:"Description"}),(0,b.jsx)("p",{className:"text-gray-300",children:d.description})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-[#daa520] mb-2 font-fredoka",children:"Token ID"}),(0,b.jsxs)("p",{className:"text-gray-300",children:["#",a]})]}),d.attributes&&d.attributes.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-[#daa520] mb-2 font-fredoka",children:"Attributes"}),(0,b.jsx)("div",{className:"space-y-2",children:d.attributes.map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between items-center bg-black/20 rounded-lg p-3",children:[(0,b.jsx)("span",{className:"text-gray-400",children:a.trait_type}),(0,b.jsx)("span",{className:"text-white font-bold",children:a.value})]},c))})]})]})]}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border border-[#daa520]/20 p-6",children:[(0,b.jsxs)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:["üí∞ Available Listings ",p.length>0&&`(${p.length})`]}),l?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-[#daa520] mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Loading listings..."})]}):0===p.length?(0,b.jsx)("p",{className:"text-gray-400 text-center py-8",children:"No active listings for this NFT. Check back later!"}):(0,b.jsxs)("div",{className:"space-y-3",children:[p.map((a,c)=>(0,b.jsx)("div",{className:"bg-black/20 rounded-lg p-4 border border-gray-700 hover:border-[#daa520]/40 transition",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Seller"}),(0,b.jsxs)("p",{className:"text-sm text-white font-mono",children:[a.seller.slice(0,6),"...",a.seller.slice(-4),a.seller===m&&(0,b.jsx)("span",{className:"ml-2 text-xs text-[#daa520] font-bold",children:"(You)"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Price per NFT"}),(0,b.jsxs)("p",{className:"text-sm text-white font-bold",children:[(Number(a.pricePerItem)/1e18).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," BASED"]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["Qty: ",a.amount.toString()," | Total: ",(Number(a.totalPrice)/1e18).toFixed(2)," BASED"]})]}),(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)("button",{onClick:()=>q(a),disabled:!n||o.isPending||a.seller===m,className:`
                        w-full py-2 px-4 rounded-lg font-fredoka font-bold text-sm transition-all
                        ${!n||a.seller===m?"bg-gray-700 text-gray-500 cursor-not-allowed":0===c?"bg-gradient-to-r from-green-600 to-green-500 text-white hover:scale-105 shadow-lg shadow-green-600/20":"bg-gradient-to-r from-[#daa520] to-yellow-600 text-black hover:scale-105 shadow-lg shadow-[#daa520]/20"}
                      `,children:n?a.seller===m?"Your Listing":o.isPending?"Buying...":0===c?"‚úÖ Best Price":"üí∞ Buy Now":"üîó Connect"})})]})},`${a.seller}-${a.tokenId}-${c}`)),p.length>1&&(0,b.jsx)("div",{className:"mt-3 p-3 bg-green-900/20 border border-green-600/30 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-green-400 text-center",children:"üí° Tip: Listings are sorted by price. The top listing offers the best deal!"})})]})]}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-[#daa520]/10 to-yellow-600/10 rounded-lg border border-[#daa520]/20 p-6",children:[(0,b.jsx)("h3",{className:"text-2xl font-bold text-[#daa520] mb-4 font-fredoka",children:"üìä Trading History"}),(0,b.jsx)("p",{className:"text-gray-400 text-center py-8",children:"Trading history feature coming soon! This will show all transactions, offers, and sales for this specific NFT."})]})]})}var K=a.i(413014);function L(){let[a,f]=(0,c.useState)("mint");return(0,b.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,b.jsx)(d.Header,{}),(0,b.jsx)("main",{className:"flex-1 bg-gradient-to-b from-black to-gray-950",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-12 sm:px-6 lg:px-8",children:[(0,b.jsx)(K.BlurredTitleSection,{title:"ùïÇ∆éùïÇ‰∏Ö·µâÂåöüÖ∑ Marketplace",subtitle:"Mint new NFTs or trade KEKTV vouchers"}),(0,b.jsx)("div",{className:"mb-8 space-y-4",children:(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsxs)("div",{className:"inline-flex gap-2 rounded-xl bg-gray-900/60 p-1 border border-gray-800",children:[(0,b.jsx)("button",{onClick:()=>f("mint"),className:`
                    px-8 py-3 rounded-lg font-fredoka font-bold transition-all duration-200
                    ${"mint"===a?"bg-[#3fb8bd] text-black shadow-lg shadow-[#3fb8bd]/20":"text-[#3fb8bd] hover:text-white hover:bg-gray-800/50"}
                  `,children:"Mint"}),(0,b.jsx)("button",{onClick:()=>f("surprise"),className:`
                    px-8 py-3 rounded-lg font-fredoka font-bold transition-all duration-200 text-2xl
                    ${"surprise"===a?"bg-[#4ecca7] shadow-lg shadow-[#4ecca7]/20":"hover:bg-gray-800/50"}
                  `,children:"üëÄ"}),(0,b.jsx)("button",{onClick:()=>f("kektv"),className:`
                    px-8 py-3 rounded-lg font-fredoka font-bold transition-all duration-200
                    ${"kektv"===a?"bg-[#daa520] text-black shadow-lg shadow-[#daa520]/20":"text-[#daa520] hover:text-white hover:bg-gray-800/50"}
                  `,children:"ùïÇ∆éùïÇTV"}),(0,b.jsx)("button",{onClick:()=>f("limited"),className:`
                    px-8 py-3 rounded-lg font-fredoka font-bold transition-all duration-200
                    ${"limited"===a?"bg-purple-500 text-white shadow-lg shadow-purple-500/20":"text-purple-400 hover:text-white hover:bg-gray-800/50"}
                  `,children:"Limited Edition"})]})})}),(0,b.jsxs)("div",{className:"mt-8",children:["mint"===a&&(0,b.jsx)(g,{}),"surprise"===a&&(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"üëÄ"}),(0,b.jsx)("h2",{className:"text-3xl font-bold text-[#4ecca7] mb-4 font-fredoka",children:"Surprise Mechanics"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"Exciting surprise features coming soon! Stay tuned"})]}),"kektv"===a&&(0,b.jsx)(F,{}),"limited"===a&&(0,b.jsxs)("div",{className:"text-center py-24",children:[(0,b.jsx)("div",{className:"text-8xl mb-6",children:"‚≠ê"}),(0,b.jsx)("h2",{className:"text-3xl font-bold text-purple-400 mb-4 font-fredoka",children:"Limited Edition"}),(0,b.jsx)("p",{className:"text-gray-400 max-w-md mx-auto",children:"Exclusive limited edition NFTs. Check back soon for rare drops!"})]})]})]})}),(0,b.jsx)(e.Footer,{})]})}}];

//# sourceMappingURL=3d860_kektechbmad100_kektech-mainnet-frontend_app_marketplace_page_tsx_ed8fd2ca._.js.map